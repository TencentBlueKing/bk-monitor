{"ops":[{"insert":"这是一个文件导入组件。该组件的主要作用是为用户提供一个可点击的交互区域（通常显示为“导入”文字），当用户点击时，会触发隐藏的文件选择对话框，允许用户选择本地文件并读取其内容，然后将文件内容以指定格式传递给父组件进行后续处理。\n\n基本用途"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n该组件封装了文件选择与读取的逻辑，简化了在 Vue 项目中实现导入文件功能的开发工作。开发者无需重复编写文件选择、FileReader 读取等代码，只需引入此组件并监听其事件即可获取用户选择的文件内容。\n\n主要功能"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n1. 点击触发文件选择：组件渲染一个可点击的元素（默认显示文案为“导入”，可通过插槽自定义），点击后弹出系统文件选择窗口。\n2. 支持限制文件类型：通过 `accept` 属性可以限制用户只能选择特定类型的文件（如 `.json` 文件）。\n3. 支持多种内容读取方式：\n   - 默认以文本形式读取文件内容（使用 `readAsText`）。\n   - 若设置 `base64` 属性为 `true`，则以 Base64 编码格式读取文件（使用 `readAsDataURL`）。\n4. 可选返回文件信息：如果设置 `returnFileInfo` 为 `true`，则返回的数据中会包含文件名、文件字符串内容以及文件大小；否则只返回文件内容本身。\n5. 支持禁用状态：通过 `disabled` 属性可以控制该组件是否可点击。\n6. 隐藏原生 input 元素：实际的 `<input type=\"file\">` 被隐藏，通过样式控制其不可见但仍然可操作。\n\n主要属性（Props）"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n| 属性名称         | 类型     | 默认值   | 说明                                                         |\n|------------------|----------|----------|--------------------------------------------------------------|\n| returnFileInfo   | Boolean  | false    | 是否返回包含文件名、大小等附加信息的对象                     |\n| accept           | String   | '.json'  | 限制用户可选择的文件类型，如 '.json'、'.txt' 等               |\n| base64           | Boolean  | false    | 是否以 Base64（Data URL）方式读取文件内容                     |\n| disabled         | Boolean  | false    | 是否禁用该导入功能，禁用后点击不会触发文件选择                 |\n\n事件（Events）"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n| 事件名称 | 说明                                       | 返回数据内容                                                     |\n|----------|--------------------------------------------|------------------------------------------------------------------|\n| change   | 当用户选择文件并成功读取后触发的事件       | 根据配置不同，可能返回文本内容、Base64 数据或包含文件信息的对象 |\n\n- 若 `returnFileInfo: true`，返回对象结构大致如下：\n\n"},{"attributes":{"code-block":"plain"},"insert":"\n"},{"insert":"  {"},{"attributes":{"code-block":"plain"},"insert":"\n"},{"insert":"    name: 'filename.json',  // 文件名"},{"attributes":{"code-block":"js"},"insert":"\n"},{"insert":"    fileStr: '文件内容或Base64编码',  // 文件内容或 Data URL"},{"attributes":{"code-block":"js"},"insert":"\n"},{"insert":"    size: 1024             // 文件大小（字节）"},{"attributes":{"code-block":"plain"},"insert":"\n"},{"insert":"  }"},{"attributes":{"code-block":"js"},"insert":"\n\n"},{"insert":"- 若 `returnFileInfo: false`，则直接返回文件内容（文本或 Base64）。\n\n使用方法"},{"attributes":{"header":1},"insert":"\n"},{"attributes":{"code-block":"plain"},"insert":"\n"},{"insert":"<template>"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  <div>"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    <!-- 基本用法，默认显示“导入”文字，读取文本文件内容 -->"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    <monitor-import @change=\"onFileChange\" />"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"    <!-- 自定义显示文字 -->"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    <monitor-import @change=\"onFileChange\">"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      选择 JSON 文件"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    </monitor-import>"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"    <!-- 只接受 .json 文件，并返回文件信息（文件名、内容、大小） -->"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    <monitor-import "},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      accept=\".json\" "},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      :return-file-info=\"true\" "},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      @change=\"onFileChange\" "},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    />"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"    <!-- 以 Base64 方式读取文件 -->"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    <monitor-import "},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      :base64=\"true\" "},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      @change=\"onFileChange\" "},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    />"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"    <!-- 禁用状态 -->"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    <monitor-import "},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      :disabled=\"true\" "},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      @change=\"onFileChange\" "},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    />"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  </div>"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"</template>"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"\n事件处理示例"},{"attributes":{"header":1},"insert":"\n"},{"attributes":{"code-block":"plain"},"insert":"\n"},{"insert":"<script lang=\"ts\">"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"import { Vue } from 'vue-property-decorator';"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"export default class YourComponent extends Vue {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  onFileChange(fileContent) {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    console.log('用户选择的文件内容为：', fileContent);"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"    // 如果启用了 returnFileInfo，fileContent 可能是："},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    // {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    //   name: 'data.json',"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    //   fileStr: '文件内容...',"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    //   size: 1024"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    // }"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    // 否则可能是直接的文本内容或 Base64 字符串"},{"attributes":{"code-block":"plain"},"insert":"\n"},{"insert":"  }"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"}"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"</script>"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"\n实现细节说明"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n- 使用了 Vue 的 Class Component 风格（通过 `vue-property-decorator` 实现），包括 `@Component`、`@Prop`、`@Emit`、`@Ref` 等装饰器。\n- 文件选择是通过隐藏的 `<input type=\"file\">` 实现的，通过调用其 `click()` 方法弹出文件选择窗口。\n- 文件读取使用 `FileReader` API，根据配置决定是读取为文本还是 Base64。\n- 通过 Promise 包装 FileReader 的异步读取过程，确保在数据读取完成后再触发 `change` 事件。\n- 样式上通过绝对定位将原生 input 覆盖在可点击元素之上，但保持其不可见，实现“点击任意位置都可触发文件选择”的效果。\n\n注意事项"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n1. **组件命名问题**：代码中 `@Component({ name: 'MonitorExport' })` 的组件名写为了 `MonitorExport`，但从文件名和功能上看，可能应为 `MonitorImport`，建议确认是否为笔误。\n2. **类型定义简略**：`event.target.files` 的类型被简单定义为 `any[]`，在实际项目中建议使用更严格的 TypeScript 类型定义，如 `FileList` 或 `File`。\n3. **错误处理较简单**：在文件读取过程中如果发生异常，当前只是返回空对象 `{}`，可根据需求增强错误提示或日志记录。\n"}],"extra":{"updator":"Austin","update_at":"2026-01-21 16:21:54"}}