{"ops":[{"insert":"这是一个带有加载或失败提示信息的弹窗对话框的组件，通常用于在用户进行某些异步操作（如注册、提交、轮询等）时，向用户展示当前操作的状态（加载中或失败及原因），并允许用户在失败时手动关闭弹窗。\n\n基本用途"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n- 显示某个后台操作（比如注册、数据同步等）正在进行中的加载状态；\n- 如果操作失败，显示失败图标和失败原因；\n- 支持用户手动关闭弹窗（仅在失败状态下显示关闭按钮）；\n- 弹窗本身不可通过点击关闭图标或遮罩关闭（由父组件控制显隐）。\n\n主要功能"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n1. 弹窗展示控制"},{"attributes":{"header":2},"insert":"\n"},{"insert":"   - 通过 props 中的 show（布尔值）控制弹窗是否显示；\n   - 弹窗使用了 bk-dialog 组件（可能来自蓝鲸前端组件库），主题为 primary，无关闭图标，没有页脚，标题位置在左侧。\n\n2. 状态区分显示"},{"attributes":{"header":2},"insert":"\n"},{"insert":"   - 根据传入的 status 对象来决定显示“加载中”还是“失败”状态：\n     - 若 status.failMsg 不存在 → 显示加载动画 + 加载提示信息；\n     - 若 status.failMsg 存在 → 显示失败图标 + 错误信息和失败原因，并提供关闭按钮。\n\n3. 多语言支持"},{"attributes":{"header":2},"insert":"\n"},{"insert":"   - 使用了 this.$t() 方法，说明该组件支持国际化（i18n），比如 “等待中” 和 “关闭窗口” 可能会被翻译成不同语言。\n\n4. 交互功能"},{"attributes":{"header":2},"insert":"\n"},{"insert":"   - 提供一个关闭按钮（仅在失败时显示），点击后通过 emit 事件通知父组件将 show 设为 false，从而关闭弹窗。\n\nProps组件参数"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n1. status（Object 类型，必传）\n   - 用于控制弹窗内部显示内容与状态，包含如下字段：\n     - msg（String）：主要提示信息，无论是加载中还是失败都会显示，例如“正在注册”或“注册失败”。\n     - failMsg（String，可选）：失败原因描述，如果存在，则表示操作失败，会显示错误图标和具体失败原因。\n   - 判断逻辑：\n     - 若 status.failMsg 为 falsy（比如 undefined、null 或空字符串）→ 显示加载状态；\n     - 若 status.failMsg 有值 → 显示失败状态。\n\n2. show（Boolean 类型，必传）\n   - 控制弹窗是否显示，由父组件传入并控制。该组件不直接修改 show，而是通过 emit 事件让父组件更新。\n"},{"attributes":{"header":1},"insert":"\n"},{"insert":"方、法"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n- close()\n  - 功能：关闭弹窗。\n  - 实现：通过 this.$emit('update:show', false) 通知父组件将 show 值设为 false，从而关闭弹窗。\n  - 说明：该写法通常意味着父组件使用了 Vue 的 v-model 或 .sync 语法糖来双向绑定 show 值。\n\n组件结构（Template）"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n- 外层使用的是 bk-dialog 弹窗容器，配置为不可自行关闭（无关闭图标、无页脚）。\n- 内部根据 status.failMsg 是否存在，分为两种 UI 状态：\n\n1. 加载中状态（status.failMsg 不存在时）"},{"attributes":{"header":2},"insert":"\n"},{"insert":"- 显示一个自定义的加载图标组件 `<svg-loading-icon />`；\n- 显示一段主要提示信息 status.msg；\n- 显示“等待中”小字提示。\n\n2. 失败状态（status.failMsg 存在时）"},{"attributes":{"header":2},"insert":"\n"},{"insert":"- 显示一个警告图标（bk-icon icon-exclamation-circle-shape）；\n- 显示主要提示信息 status.msg；\n- 显示失败原因：“原因: xxx”（xxx 来自 status.failMsg）；\n- 显示一个“关闭窗口”按钮，点击可关闭弹窗。\n\n使用方法"},{"attributes":{"header":1},"insert":"\n"},{"attributes":{"code-block":"plain"},"insert":"\n"},{"insert":"<template>"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  <div>"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    <!-- 触发按钮 -->"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    <button @click=\"handleRegister\">注册</button>"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"    <!-- PollingLoading 弹窗 -->"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    <polling-loading"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      :show=\"isDialogVisible\""},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      :status=\"dialogStatus\""},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    />"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  </div>"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"</template>"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"attributes":{"code-block":"plain"},"insert":"\n"},{"insert":"<script>"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"import PollingLoading from './polling-loading.vue';"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"export default {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  components: {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    PollingLoading,"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  },"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  data() {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    return {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      isDialogVisible: false, // 控制弹窗显示/隐藏"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      dialogStatus: {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"        msg: '',       // 提示信息，如“正在注册”或“注册失败”"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"        failMsg: null, // 失败原因，如果没有则为 null 或 undefined"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      },"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    };"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  },"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  methods: {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    handleRegister() {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      // 打开弹窗，显示加载状态"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      this.dialogStatus = {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"        msg: '正在注册，请稍候',"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"        failMsg: null,"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      };"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      this.isDialogVisible = true;"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"      // 模拟异步请求"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      setTimeout(() => {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"        // 假设注册失败"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"        this.dialogStatus = {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"          msg: '注册失败',"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"          failMsg: '网络异常，请稍后重试',"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"        };"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      }, 3000);"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    },"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  },"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"};"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"</script>"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"\n参数传递说明"},{"attributes":{"header":2},"insert":"\n"},{"insert":"\n- :show=\"isDialogVisible\"  \n  控制弹窗的显示与隐藏，建议使用布尔值，由父组件管理状态。\n\n- :status=\"dialogStatus\"  \n  传递一个对象，包含：\n  - msg：主提示信息，如“正在处理”、“操作成功”、“操作失败”等；\n  - failMsg：失败原因（可选），如果存在，则显示为失败状态。\n\n总结"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\npolling-loading.vue 是一个**通用的、带状态提示的弹窗组件**，适用于：\n\n- 异步操作过程中向用户展示“加载中”状态；\n- 操作失败时展示失败原因，并允许用户手动关闭；\n- 适合与轮询逻辑、注册、提交等需要反馈用户操作状态的场景配合使用。\n\n该组件设计简洁、可复用性强，通过 props 控制状态和显示，通过事件与父组件通信，是典型的 Vue 组件化开发实践。\n"}],"extra":{"updator":"Austin","update_at":"2026-01-21 17:05:04"}}