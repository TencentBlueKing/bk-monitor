{"ops":[{"insert":"这是一个可滚动列表组件，主要用于展示可滚动的数据项，并支持不同的分页加载模式。\n\n基本用途"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n该组件名为 `ScrollList`，是一个封装好的 Vue 组件，用于以列表形式展示一组数据（如表格行、选项等），并支持以下特性：\n\n- 垂直滚动展示内容；\n- 支持三种不同的数据加载/分页模式：无分页、同步分页、异步分页；\n- 当滚动到列表底部特定位置（通过一个锚点元素判断）时，触发相应的加载逻辑；\n- 提供基础的 UI 样式，包括边框、阴影、hover 效果、选中状态等；\n- 列表项可响应点击事件（hover 变色，支持选中样式）；\n- 在无数据时显示“暂无数据”的占位提示。\n"},{"attributes":{"header":1},"insert":"\n"},{"insert":"主要功能"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n1. 核心功能 —— 滚动列表展示"},{"attributes":{"header":2},"insert":"\n"},{"insert":"\n- 使用 `scroll-list.scss` 定义了组件的样式，包括外层容器 `.scroll-list` 的布局、边框、圆角、阴影、内边距等；\n- 列表项使用 `.scroll-list-item` 样式，支持 flex 布局、高度固定为 32px、hover 时背景变色、以及激活状态的特殊样式（蓝色文字和背景）；\n- 支持通过 `data` 属性传入要展示的列表项数组，每个项至少包含 `id` 和 `name` 字段。\n\n2. 支持三种数据加载模式（通过 mode 属性控制）"},{"attributes":{"header":2},"insert":"\n"},{"insert":"\n定义在 `type.ts` 中的枚举 `ScrollPageMode` 包括：\n\n- `NoPaging`（无分页）：一次性加载所有数据，直接全部展示，不触发额外加载逻辑；\n- `Async`（异步分页）：当滚动到底部时，通过调用传入的 `getData(page)` 方法异步加载下一页数据；\n- `Sync`（同步分页）：类似分页加载，但数据是由父级一次性传入，组件内部通过切片方式模拟分页加载（用于特殊控制场景）。\n\n3. 底部锚点与滚动监听"},{"attributes":{"header":2},"insert":"\n"},{"insert":"\n- 使用 `IntersectionObserver` API 监听一个不可见的锚点元素（`.scroll-list-anchor`），当该元素进入视口时，认为用户滚动到了列表底部附近，从而触发对应的加载逻辑；\n- 在 `Async` 模式下，会调用 `getData(page + 1)` 加载更多数据；\n- 在 `Sync` 模式下，会逐步将传入的数据分片展示出来，模拟逐步加载的效果；\n- 在 `NoPaging` 模式下，不会进行任何额外的加载或观察操作。\n\n4. 加载状态与空数据展示"},{"attributes":{"header":2},"insert":"\n"},{"insert":"\n- 异步加载时显示加载动画（通过 `bk-loading` 组件，假设是蓝鲸 UI 或某个 UI 库提供的组件）；\n- 如果传入的 `data` 为空数组，则展示 `bk-exception` 组件提示“暂无数据”（也是假设来自某个 UI 库）；\n- 支持国际化，使用了 `this.$t('暂无数据')`，表明项目可能集成了 vue-i18n。\n\n使用方法"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n1. 引入组件"},{"attributes":{"header":2},"insert":"\n"},{"insert":"\n首先需要在使用的地方引入 `ScrollList` 组件（假设你使用的是 Vue + TypeScript 项目，如 Vue CLI 或 Vite + Vue 3）。\n\n2. 准备数据"},{"attributes":{"header":2},"insert":"\n"},{"insert":"\n数据项的类型应符合 `IScrollListItem` 接口，即每个对象至少包含：\n"},{"attributes":{"code-block":"plain"},"insert":"\n"},{"insert":"{"},{"attributes":{"code-block":"plain"},"insert":"\n"},{"insert":"  id: number | string; // 唯一标识"},{"attributes":{"code-block":"plain"},"insert":"\n"},{"insert":"  name: string;        // 显示名称"},{"attributes":{"code-block":"plain"},"insert":"\n"},{"insert":"}"},{"attributes":{"code-block":"plain"},"insert":"\n\n"},{"insert":"\n3. 定义加载数据的函数（仅 Async 模式需要）"},{"attributes":{"header":2},"insert":"\n"},{"insert":"\n如果你使用的是 `Async` 分页模式，需要传入一个异步函数 `getData(page: number): Promise<IScrollListItem[]>`，用于拉取指定页码的数据。\n\n4. 使用组件示例"},{"attributes":{"header":2},"insert":"\n"},{"attributes":{"code-block":"plain"},"insert":"\n"},{"insert":"<template>"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  <ScrollList"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    :data=\"listData\""},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    :mode=\"mode\""},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    :page=\"currentPage\""},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    :page-size=\"pageSize\""},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    :total=\"totalCount\""},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    :get-data=\"fetchMoreData\""},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    @page-change=\"onPageChange\""},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  />"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"</template>"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"<script lang=\"ts\">"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"import { defineComponent, ref } from 'vue';"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"import ScrollList, { ScrollPageMode } from './ScrollList';"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"export default defineComponent({"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  components: {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    ScrollList,"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  },"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  setup() {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    const listData = ref<IScrollListItem[]>([]);"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    const mode = ref<ScrollPageMode>(ScrollPageMode.Async); // 或 NoPaging / Sync"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    const currentPage = ref(1);"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    const pageSize = ref(10);"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    const totalCount = ref(0);"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"    // 模拟异步获取数据的方法"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    const fetchMoreData = async (page: number) => {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      // 这里应该是真实的 API 请求"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      console.log('Fetching page:', page);"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      // 假设返回一些模拟数据"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      const newData = Array.from({ length: 10 }, (_, i) => ({"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"        id: (page - 1) * 10 + i + 1,"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"        name: `Item ${(page - 1) * 10 + i + 1}`,"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      }));"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      return newData;"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    };"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"    const onPageChange = (page: number) => {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      console.log('Page changed to:', page);"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      currentPage.value = page;"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    };"},{"attributes":{"code-block":"plain"},"insert":"\n\n"},{"insert":"    // 初始化数据（可选）"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    // fetchData(1).then(data => { listData.value = data; });"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"    return {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      listData,"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      mode,"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      currentPage,"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      pageSize,"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      totalCount,"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      fetchMoreData,"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      onPageChange,"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    };"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  },"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"});"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"</script>"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"\nProps 说明"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n| 参数名     | 类型                        | 默认值             | 说明 |\n|------------|-----------------------------|--------------------|------|\n| data       | IScrollListItem[]           | []                 | 要展示的列表数据 |\n| mode       | ScrollPageMode              | ScrollPageMode.NoPaging | 分页模式：NoPaging（无分页）、Async（异步加载）、Sync（同步分片加载） |\n| page       | number                      | 1                  | 当前页码（主要用于 Async 模式） |\n| pageSize   | number                      | 1                  | 每页大小（未在代码中实际使用，但作为 props 传入） |\n| total      | number                      | 0                  | 数据总条数（用于判断是否还有更多数据可加载） |\n| getData    | (page: number) => Promise<IScrollListItem[]> | - | 异步获取数据的函数，仅在 Async 模式下使用 |\n\n事件说明"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n| 事件名     | 参数            | 说明 |\n|------------|-----------------|------|\n| pageChange | (page: number)  | 页面发生改变时触发（目前代码中未主动触发，但接口已预留） |\n\n总结"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n这个 `ScrollList` 组件是一个高度可配置、支持多种数据加载模式的 Vue 滚动列表控件，适用于需要展示大量可滚动条目并支持懒加载/分页的场景，比如：\n\n- 后台管理系统中的数据列表；\n- 聊天记录滚动展示；\n- 商品、文章、日志等列表展示并支持动态加载更多。\n\n它通过灵活的模式配置和底层的 IntersectionObserver 滚动监听机制，实现了流畅的用户体验和良好的性能表现。如果配合具体的 UI 组件库（如示例中的 bk-loading 和 bk-exception），可以快速融入现有系统。\n"}],"extra":{"updator":"Austin","update_at":"2026-01-21 17:25:18"}}