{"ops":[{"insert":"这是一个基于 Vue.js 和 TypeScript 开发的前端组件，用于实现“跨页选择”功能（通常在数据表格或列表中，允许用户在当前页选择或跨多页统一选择数据项）。下面是对该代码的详细解析：\n\n整体功能概述"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n这个组件名为 `AcrossPageSelection`，它是一个 UI 组件，提供一个 **复选框 + 下拉菜单** 的交互形式，用户可以选择：\n\n- 不选择（默认）\n- 仅选择当前页内容（\"本页全选\"）\n- 跨所有页面进行统一选择（\"跨页全选\"）\n\n主要用于数据列表/表格中，控制多页数据的选中状态，常见于后台管理系统。\n\n使用方法"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n假设你是在一个 Vue 项目中（支持 TSX 或已配置 vue-tsx-support），你可以这样使用该组件：\n\n1. 示例代码："},{"attributes":{"header":2},"insert":"\n"},{"insert":"\n"},{"attributes":{"code-block":"plain"},"insert":"\n"},{"insert":"<template>"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  <div>"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    <AcrossPageSelection"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      :value=\"currentPageSelectionState\""},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      @change=\"onSelectionChange\""},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    />"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  </div>"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"</template>"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"<script lang=\"ts\">"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"import { defineComponent, ref } from 'vue';"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"import AcrossPageSelection, { SelectTypeEnum } from './across-page-selection';"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"export default defineComponent({"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  components: {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    AcrossPageSelection,"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  },"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  setup() {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    const currentPageSelectionState = ref<SelectTypeEnum>(SelectTypeEnum.UN_SELECTED);"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"    const onSelectionChange = (value: SelectTypeEnum) => {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      console.log('用户选择了:', value);"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      currentPageSelectionState.value = value;"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      // 根据 value 执行对应的逻辑，比如："},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      // - value === SelectTypeEnum.SELECTED：只选中当前页"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      // - value === SelectTypeEnum.ALL_SELECTED：跨页全选"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      // - value === SelectTypeEnum.UN_SELECTED：清除选择"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    };"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"    return {"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      currentPageSelectionState,"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"      onSelectionChange,"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"    };"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"  },"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"});"},{"attributes":{"code-block":"vue"},"insert":"\n"},{"insert":"</script>"},{"attributes":{"code-block":"vue"},"insert":"\n\n"},{"insert":"\n2. 参数说明"},{"attributes":{"header":2},"insert":"\n"},{"insert":"\n| 参数名 | 类型 | 默认值 | 说明 |\n|--------|------|--------|------|\n| value | SelectTypeEnum | `SelectType.UN_SELECTED (0)` | 当前选择状态，可以是：未选择(0)、本页全选(1)、部分选中(2)、跨页全选(3) |\n| onChange | (v: SelectTypeEnum) => void | 无 | 选择状态发生变化时触发的回调函数，用于通知父组件用户的操作 |\n\n3. 交互逻辑"},{"attributes":{"header":2},"insert":"\n"},{"insert":"\n- 初始状态是 “未选择”（value = 0）。\n- 用户点击复选框或右侧箭头图标，会弹出一个下拉菜单。\n- 菜单中有两个选项：\n  - **本页全选**：设置状态为 `SelectType.SELECTED (1)`\n  - **跨页全选**：设置状态为 `SelectType.ALL_SELECTED (3)`\n- 用户选择任一项后，会通过 `onChange` 事件将新状态传递给父组件，父组件可以据此执行后续逻辑（如向后台发送请求，更新选中状态等）。\n\n技术栈总结"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n| 技术/库 | 说明 |\n|--------|------|\n| Vue.js | 组件框架，用于构建用户界面 |\n| TypeScript | 提供类型安全 |\n| vue-property-decorator | Vue 的装饰器语法支持（如 @Component, @Prop） |\n| vue-tsx-support | 支持在 Vue 中使用 TSX（React风格的JSX）编写模板 |\n| SCSS | CSS 预处理器，用于编写更灵活的样式 |\n| BK UI 组件库（如 bk-checkbox, bk-popover） | 企业级 UI 组件，可能来自 蓝鲸平台（如腾讯蓝鲸）|\n\n适用场景"},{"attributes":{"header":1},"insert":"\n"},{"insert":"\n- 数据表格/列表页面，尤其是**分页展示**的数据。\n- 需要提供「本页全选」和「跨页全选」功能的业务场景。\n- 需要良好的交互反馈与 UI 设计（如下拉菜单、hover 效果等）。\n\n例如：后台管理系统中的「批量操作」功能，比如批量删除、批量导出、批量移动等，用户可能需要先选择数据，而数据又分布在多个页面上。\n\n这是一个典型且封装良好的 Vue + TS 组件，适合在需要“跨页选择”功能的后台系统中复用，具有高可维护性与类型安全的特点。\n"}],"extra":{"updator":"Austin","update_at":"2026-01-20 15:35:22"}}